function SeamlessLoop(){this.is={ff:Boolean(!(window.mozInnerScreenX==null)&&/firefox/.test(navigator.userAgent.toLowerCase())),ie:Boolean(document.all&&!window.opera),opera:Boolean(window.opera),chrome:Boolean(window.chrome),safari:Boolean(!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase())&&window.getComputedStyle&&!window.globalStorage&&!window.opera)};this._total=0;this._load=0;this.cb_loaded;this.cb_loaded_flag=new Boolean;this.timeout;this.playDelay=-30;this.stopDelay=30;if(this.is.chrome)this.playDelay=-25;if(this.is.chrome)this.stopDelay=25;if(this.is.ff)this.playDelay=-25;if(this.is.ff)this.stopDelay=85;if(this.is.opera)this.playDelay=5;if(this.is.opera)this.stopDelay=0;this.next=1;this.audios=new Array;this.actual=new Array;this.dropOld=new Boolean;this.old;this._volume=1;var e=this;this._eventCanplaythrough=function(n){if(n==false){n=true;e._load++;if(e._load==e._total){e.loaded=true;if(e.cb_loaded_flag==true){e.cb_loaded();e.cb_loaded_flag=false}}}};this._eventPlaying=function(n){setTimeout(function(){n.pause();try{n.currentTime=0}catch(e){}},e.stopDelay);if(e.dropOld==true){setTimeout(function(){if(e.old.paused==false){e.old.pause();try{e.old.currentTime=0}catch(n){}}},e.stopDelay);e.dropOld=false}};this._eventEnded=function(e){e.volume=this._volume};this.doLoop=function(){var e=this.next==1?"_1":"_2";var t=this.next==1?"_2":"_1";var n=this;this.timeout=setTimeout(function(){n.doLoop()},this.actual._length+this.playDelay);if(this.is.opera)this.actual[t].pause();this.actual[e].play();this.next*=-1};this.isLoaded=function(){return Boolean(this._load==this._total)}}SeamlessLoop.prototype.start=function(e){if(e!=""){this.actual=this.audios[e]}this.doLoop()};SeamlessLoop.prototype.volume=function(e){if(typeof e!="undefined"){this.actual._1.volume=e;this.actual._2.volume=e;this._volume=e}return e};SeamlessLoop.prototype.stop=function(){clearTimeout(this.timeout);this.actual._1.currentTime=0;this.actual._1.pause();this.actual._2.currentTime=0;this.actual._2.pause()};SeamlessLoop.prototype.callback=function(e){this.cb_loaded=e;if(this.isLoaded()==true)e();else this.cb_loaded_flag=true};SeamlessLoop.prototype.update=function(e,t){var n=this.next==1?"_2":"_1";this.old=this.actual[n];this.actual=this.audios[e];if(t==false){if(this.old.paused==false){this.dropOld=true;if(this.is.opera)this.old.pause()}clearTimeout(this.timeout);this.doLoop()}};SeamlessLoop.prototype.addUri=function(e,t,n){this.audios[n]=new Array;this.audios[n]._length=t;var r=this;this.audios[n]._1_isLoaded=new Boolean;this.audios[n]._2_isLoaded=new Boolean;this.audios[n]._1=new Audio(e);this.audios[n]._2=new Audio(e);this._total++;this.audios[n]._1.addEventListener("canplaythrough",function(){r._eventCanplaythrough(r.audios[n]._1_isLoaded)});this.audios[n]._2.addEventListener("canplaythrough",function(){r._eventCanplaythrough(r.audios[n]._2_isLoaded)});this.audios[n]._1.addEventListener("playing",function(){r._eventPlaying(r.audios[n]._2)});this.audios[n]._2.addEventListener("playing",function(){r._eventPlaying(r.audios[n]._1)});this.audios[n]._1.addEventListener("ended",function(){r._eventEnded(r.audios[n]._1)});this.audios[n]._2.addEventListener("ended",function(){r._eventEnded(r.audios[n]._2)});this.audios[n]._1.load();this.audios[n]._2.load();this.audios[n]._1.volume=this._volume;this.audios[n]._2.volume=this._volume}