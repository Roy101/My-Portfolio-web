var HI_RES=(1<window.devicePixelRatio&&1300<screen.width||2E3<screen.width)&&hires?!0:!1,IMG_POSTFIX=HI_RES?"@2x":"",SOUND_URL="https://shiblee.me/igneous/sounds/loop.mp3",TERRAIN_URL_BASE="https://shiblee.me/igneous/images/planet/",PAGE_SCROLL_INTERVAL=!1,COOKIE_EXPIRATION_DATE=new Date((new Date).setTime((new Date).getTime()+31536E6)),VOLUME=0,VOLUME_INTERVAL=!1,VOLUME_MAX=1,VOLUME_SPEED=.01,PLAY_SOUND=1==getCookie("PLAY_SOUND")||""==getCookie("PLAY_SOUND")?!0:!1,WINDOW_FOCUS=!0,WINDOW_WIDTH=$(window).width(),
WINDOW_HEIGHT=$(window).height(),LARGE_TILES=$(".largeTile article"),ARTICLES=$("article"),LAYERS="sky terrain5-horizon terrain4 terrain3 terrain2 terrain1-closest".split(" "),LAYER_WIDTH=[3600,7E3,6E3,6E3,6E3,6E3],LAYER_HEIGHT=[1800,484,1280,1014,600,162],LAYER_DURATION=[0,36500,4E4,6E4,1E5,2E5],wheelX=wheelY=0,pageFit=0,pageLength=0,pageStages=[],pageStageIndex=-1,pageVisible=!1,tileMargin=0,tileWidth=0,lastScroll=0,hash=getHash(),fastStart=amazon||google||1<hash.length||debug||crawler?!0:!1,pageStart=
!0,lockNav=!1,backgroundSound={},buttonSound={},partial=firefox||msie?supported:!1,highEndDevice=debug&&!mobile||effects?!0:!1,nameIntro=titleIntro=introVisible=!1;(function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e;a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)};a[e].l=1*new Date;f=b.createElement(c);g=b.getElementsByTagName(c)[0];f.async=1;f.src=d;g.parentNode.insertBefore(f,g)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-19875648-1","shiblee.me");
ga("send","pageview");function setCookie(a,b){var c="expires="+COOKIE_EXPIRATION_DATE.toGMTString();document.cookie=a+"="+b+"; "+c}function getCookie(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){var d=b[c].trim();if(0==d.indexOf(a))return d.substring(a.length,d.length)}return""}function getHash(){var a=window.location.hash;if(2>a.length)return"";window.location.hash="";return a}
function setTooltip(){$.fn.qtip.zindex=21E3;$.fn.qtip.modal_zindex=21E3;$(".tooltip").each(function(a){$(this).qtip({content:{text:$.parseHTML($(this).attr("data-tooltip"))},position:{my:"top center",at:"bottom center",target:$(this),viewport:$(window),effect:function(a,c,d){$(this).animate(c,{duration:600,easing:"easeInOut",queue:!1})}},style:{classes:"qtip-bootstrap qtip-shadow",tip:{corner:!0}},show:{effect:function(a){$(this).fadeIn()}},hide:{effect:function(a){$(this).fadeOut()}}})})}
function scrollPage(){$(window).scrollTop(0);$(window).scrollLeft(0)}
function setParallax(){$("#planet").parallax({calibrateX:mobile,calibrateY:mobile,limitX:mobile?250:!1,limitY:mobile?85:!1,scalarX:mobile?20:15,scalarY:mobile?15:10,frictionX:mobile?.95:.15,frictionY:mobile?.95:.15});window.DeviceOrientationEvent?window.addEventListener("deviceorientation",function(){deviceTiltEvent([event.beta,event.gamma])},!0):window.DeviceMotionEvent?window.addEventListener("devicemotion",function(){deviceTiltEvent([2*event.acceleration.x,2*event.acceleration.y])},!0):window.addEventListener("MozOrientation",
function(){deviceTiltEvent([50*orientation.x,50*orientation.y])},!0)}function deviceTiltEvent(a){}
function resizeLayers(){WINDOW_WIDTH=$(window).width();WINDOW_HEIGHT=$(window).height();lockNav=!0;for(var a=1;a<LAYERS.length;a++){var b=$("#layer"+a+" .scaled"),c=b.height()*(LAYER_WIDTH[a]/LAYER_HEIGHT[a]),d="moveLayer"+a,e=WINDOW_WIDTH/WINDOW_HEIGHT;$.keyframe.define([{name:d,from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d("+-c+"px,0,0)"}}]);b.resetKeyframe();b.css("transform","translate3d(0,0,0)");b.width(c*Math.max(2,e+.5));addTiles(a,c);b.playKeyframe({name:d,duration:LAYER_DURATION[a],
timingFunction:"linear",delay:0,repeat:"infinite",complete:function(){}})}setTileSize();positionNav();positionFooter();showFooter();1024<WINDOW_WIDTH&&pageVisible?showBackButton():hideBackButton();!isLandscape()&&pageVisible&&$("#prevButton, #nextButton").fadeOut("slow");isLandscape()?$("nav").css("z-index",15E3):$("nav").css("z-index",13999);480>WINDOW_HEIGHT?LARGE_TILES.addClass("scroll"):LARGE_TILES.removeClass("scroll");setTimeout(function(){setTimeout(function(){scrollPage()},500);moveToCurrentStage()},
100)}function setTileSize(){var a=WINDOW_HEIGHT,b=WINDOW_WIDTH,c=$(".largeTile article");455>a&&550<b?c.css({height:a-60,width:Math.min(106400/(a-100),b),top:45}):400>a?c.css({height:a-30,top:15}):c.css({width:"",height:"",top:""});310>b&&$(".largeTile article").css({width:b-30});setTimeout(function(){positionTiles()},650)}
function addTiles(a,b){var c=$("#layer"+a+" .scaled"),d=Math.floor(b/4),e=c.width(),e=Math.ceil(e/d);c.find("div").remove();for(var f=0;f<=e;f++){var g=(f+1)%4;0===g&&(g=4);$('<div class="tile" style="width:'+d+"px;left:"+f*d+'px;"><img src="'+TERRAIN_URL_BASE+"terrain-level-"+a+IMG_POSTFIX+"_0"+g+'.png"/></div').appendTo(c)}}
function positionTiles(){var a=WINDOW_WIDTH,b=320>a?15:Math.min(30,Math.ceil(.08*a)),c=$("section.largeTile article").first().width();pageFit=bestFit(a,c,b);tileMargin=b;tileWidth=c;$("section.largeTile").each(function(c){c=$(this).find("article");var e=c.length,f=$(c[0]).width(),g=0,g=a>f*e+b*(e+1)?(a-(f*e+b*(e-1)))/2:a<2*f?(a-f)/2:2*b;c.each(function(a){$(this).css("left",g);g+=f+b});$(this).width(g+2*b)});pageVisible&&setTimeout(function(){calculateStages(!0)},600)}
function positionNav(){isLandscape()?$("nav").css("top","20px"):($("nav").css("top",WINDOW_HEIGHT/2-$("nav").height()/2+"px"),introVisible&&hideIntro())}
function showName(){fastStart&&setTimeout(function(){isLandscape()&&showMenu();setTimeout(function(){1<hash.length&&0<$(hash).length?(showPage(hash),$('nav a[href="'+hash+'"]').addClass("selected")):amazon&&(showPage("#Prototypes"),$('nav a[href="#Prototypes"]').addClass("selected"))},200)},300);nameIntro=$("#name").textillate({"in":{effect:"flipInY",sync:!1,shuffle:!1,reverse:!1,autoStart:!0,loop:!1,callback:function(){introVisible=!0;showTitle()}},out:{effect:"fadeOutUp",sync:!1,shuffle:!0,reverse:!1,
autoStart:!1,loop:!1}});$("#name").css("opacity",1)}function showTitle(){titleIntro=$("#title").textillate({"in":{effect:"flipInY",sync:!1,shuffle:!1,reverse:!1,autoStart:!0,loop:!1,callback:function(){introVisible=!0;pageStart&&!fastStart&&setTimeout(function(){showMenu()},isLandscape()?100:2800)}},out:{effect:"fadeOutDown",sync:!1,shuffle:!0,reverse:!1,autoStart:!1,loop:!1,callback:function(){introVisible=!1;$("#intro").fadeOut("fast")}}});$("#title").css("opacity",1)}
function showIntro(){try{$("#intro").fadeIn("fast"),nameIntro.textillate("in"),titleIntro.textillate("in")}catch(a){}}function hideIntro(){try{nameIntro.textillate("out"),titleIntro.textillate("out")}catch(a){$("#intro").fadeIn("fast")}}
function blurBackground(){highEndDevice&&($("#layer1").addClass("blur1"),$("#layer2, #intro").addClass("blur2"),$("#layer3, #layer4").addClass("blur3"),$("#layer5").addClass("blur4"),$("#sky").addClass("blur4"));$("#vignette").removeClass("fadeOut").addClass("fadeIn")}
function unblurBackground(){$("#layer1").removeClass("blur1");$("#layer2, #intro").removeClass("blur2");$("#layer3, #layer4").removeClass("blur3");$("#layer5").removeClass("blur4");$("#sky").removeClass("blur4");$("#vignette").addClass("fadeOut")}function isLandscape(){return 550<WINDOW_WIDTH}function bestFit(a,b,c){for(var d=Math.floor(a/b),e,f=(new Date).getTime();1<d;){now=(new Date).getTime();if(3E3<now-f)break;e=b*d+c*(d+1)-a;if(0>e)return d;d--}return 1}
function calculateStages(a){a||(pageStageIndex=0);a=$("section.selected").find("article");var b=a.first().width(),c=a.length,d=Math.ceil(c/pageFit);pageStages=[0];for(var e=0,f=1;f<d;f++)e=1==pageFit?cssToNum($(a[f]).css("left"))-cssToNum($(a[0]).css("left")):f==d-1?cssToNum($(a[c-1]).css("left"))-WINDOW_WIDTH+b+2*tileMargin:cssToNum($(a[f*pageFit]).css("left"))-2*tileMargin,pageStages.push(-e);generateDots();setTimeout(function(){moveToCurrentStage();positionDots()},300)}
function movePage(a){var b=$("section.selected");b.css("-webkit-transform","translate3d("+a+"px, 0, 0)");b.css("transform","translate3d("+a+"px, 0, 0)");b.find("article.flipped").removeClass("flipped")}
function showPage(a){var b=$(a),c=fastStart;lockNav=!0;pageStageIndex=0;hidePage(!0);setTimeout(function(){b.addClass("selected");var a=b.find("article");a.each(function(b){var f=b>pageFit+2?5*b:300*b;$(this).delay(f).fadeIn(0,function(){$(this).addClass("pop");b==a.length-1&&setTimeout(function(){lockNav=!1;isLandscape()&&c&&setTimeout(function(){hideIntro()},2E3)},500)})});pageVisible=!0;pageStart=fastStart=!1;b.fadeIn("slow");b.removeClass("fadeOut");calculateStages(!1);scrollPage()},pageVisible?
2500:0);$("nav").addClass("showPage");blurBackground();showFooter();isLandscape()&&!c&&hideIntro();1024<WINDOW_WIDTH&&600<WINDOW_HEIGHT?showBackButton():hideBackButton()}
function hidePage(a){var b=$("section.selected");movePage(0);b&&(b.removeClass("selected"),LARGE_TILES.removeClass("show"),LARGE_TILES.removeClass("flipped"),b.find("article").each(function(b){var d=a?100:300;b=b>pageFit+2?b:d*b;$(this).delay(b).fadeIn(0,function(){$(this).removeClass("pop")})}),b.addClass("fadeOut"),setTimeout(function(){b.fadeOut("fast");b.removeClass("fadeOut")},1500),pageVisible=!1);a||($("nav").removeClass("showPage"),setTimeout(function(){$("nav a").removeClass("selected")},
mobile?900:100),$("#pagination").fadeOut("slow"),isLandscape()&&hideFooter(),hideBackButton(),unblurBackground(),isLandscape()&&showIntro(),lockNav=!1);$("#prevButton, #nextButton").fadeOut("slow")}function cssToNum(a){return+a.replace(/[^-\d\.]/g,"")}function next(){lockNav||(pageStageIndex++,pageStageIndex>=pageStages.length&&(pageStageIndex=pageStages.length-1),moveToCurrentStage())}function previous(){lockNav||(pageStageIndex--,0>pageStageIndex&&(pageStageIndex=0),moveToCurrentStage())}
function moveToCurrentStage(){movePage(pageStages[pageStageIndex]);moveDot(pageStageIndex);setTimeout(function(){lockNav=!1},500);if(pageVisible&&isLandscape())switch(!0){case 1===pageStages.length:$("#prevButton, #nextButton").fadeOut("slow");break;case 0===pageStageIndex:$("#prevButton").fadeOut("slow");$("#nextButton").fadeIn("slow");setNextImage();break;case pageStageIndex===pageStages.length-1:$("#prevButton").fadeIn("slow");$("#nextButton").fadeOut("slow");setPreviousImage();break;default:$("#prevButton, #nextButton").fadeIn("slow"),
setPreviousImage(),setNextImage()}}function moveDot(a){var b=+$("#pagination ul li.current a").attr("data-index"),c=$('#pagination ul li a[data-index="'+a+'"]').parent();a!=b&&($("#pagination ul li").removeClass("current current-from-right"),a<b&&c.addClass("current-from-right"),setTimeout(function(){c.addClass("current")},25))}
function positionDots(){var a=$("section.largeTile.selected article").first();a.position();var a=a.height(),b=$("#pagination").height(),a=Math.min((WINDOW_HEIGHT-a)/4-b/2,WINDOW_HEIGHT-b);600<WINDOW_HEIGHT&&(a+=25);$("#pagination").css("bottom",a)}
function generateDots(){var a=pageStages.length,b="";if(1<a){for(var c=' class="current"',d=0;d<a;d++)b+="<li"+c+'><a href="#" data-index="'+d+'">Page '+(d+1)+"</a></li>",c="";$("#pagination ul li").remove();$(b).appendTo("#pagination ul");$("#pagination").fadeIn("slow");addDotEvents()}else $("#pagination").fadeOut("slow")}function addDotEvents(){$("#pagination a").click(function(a){pageStageIndex=+$(this).attr("data-index");moveToCurrentStage();return!1})}
function setNextImage(){var a=$("section.selected article"),b=$("section.selected"),c=Math.min((pageStageIndex+2)*pageFit-1,a.length-1),d=$(a[c]).find(".main img").prop("src");$("#nextButton .thumbnail").slideUp(350,"easeInSine",function(){"Help"==b.prop("id")?$(this).css("background-image",$(a[c]).find(".mainPanel").css("background-image")):$(this).css("background-image","url("+d+")");$(this).slideDown(500,"easeOutSine")})}
function setPreviousImage(){var a=$("section.selected article"),b=$("section.selected"),c=Math.max((pageStageIndex-1)*pageFit,0),d=$(a[c]).find(".main img").prop("src");amazon&&2>c&&"Achievements"==b.prop("id")&&(d=$(a[1]).find(".main img").prop("src"));$("#prevButton .thumbnail").slideUp(350,"easeInSine",function(){"Help"==b.prop("id")?$(this).css("background-image",$(a[c]).find(".mainPanel").css("background-image")):$(this).css("background-image","url("+d+")");$(this).slideDown(500,"easeOutSine")})}
function showMenu(){$("nav a").each(function(a){$(this).delay(200*a).fadeIn(10,function(){isLandscape()?$(this).addClass("animated bounceInDown"):$(this).addClass("animated bounceInLeft")})});!isLandscape()&&introVisible&&hideIntro();showFooter();$("#warning, #loading, #curtain, #splash").remove()}
function checkPoint(){$("#warning").css("opacity",1);$("#message").addClass("animated bounceInDown");var a=$("#warningChart").get(0).getContext("2d"),b=[{label:"Chrome",value:38,color:"#6dd470"},{label:"Safari",value:17,color:"#00b1da"},{label:"Firefox",value:15,color:"#d75326"},{label:"Internet Explorer",value:5,color:"#1688c4"},{label:"Unsupported",value:25,color:"#999"}],c={segmentShowStroke:!1,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animation:!0,animationSteps:200,
animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!0,onAnimationComplete:function(){$("#warningIcon").addClass("animated bounceIn")}};setTimeout(function(){(new Chart(a)).Doughnut(b,c);setTimeout(function(){$("#messageText").addClass("animated bounceIn")},500);setTimeout(function(){$(".browserSupportIcon").each(function(a){$(this).delay(400*a).fadeIn(0,function(){$(this).addClass("animated bounceIn")})})},1E3);setTimeout(function(){$(".browserSupport img").each(function(a){$(this).delay(400*
a).fadeIn(0,function(){switch(!0){case 2>a:$(this).addClass("animated fadeInRight");break;case 1<a&&4>a:$(this).addClass("animated flipInY");break;default:$(this).addClass("animated flipInX"),setTimeout(function(){$(this).addClass("tada")},1E3)}})})},1500);setTimeout(function(){$("#message").addClass("continue");setTimeout(function(){$("#message .roundSlideButton").addClass("animated fadeIn")},1E3)},4500)},300)}
function proceed(){$("#message").removeClass("bounceInDown").addClass("fadeOutUp");init()}
function init(){$("#planet").css("opacity",1);$("#curtain, #loading").addClass("animated fadeOut");if(firefox||chrome)$(".terrain").removeClass("dim"),$("#vignette").addClass("fadeOut"),setTimeout(showName,fastStart?100:3E3);else var a=LAYERS.length-1,b=setInterval(function(){$("#layer"+a).removeClass("dim");a--;1>a&&(clearInterval(b),$("#vignette").addClass("fadeOut"),setTimeout(showName,fastStart?100:1500))},fastStart?100:1500);lockNav=!1;$("footer").css("display","block")}
function positionFooter(){var a=mobile&&!isLandscape()?20:10;600<WINDOW_HEIGHT&&(a=WINDOW_HEIGHT-$("#footer").height());$("#footer").css("top",a)}function showFooter(){!isLandscape()&&420<WINDOW_HEIGHT||600<WINDOW_HEIGHT?($("#footerRocket").removeClass("bounceOut").addClass("bounceIn"),setTimeout(function(){$("#footerFirst").removeClass("bounceOut").addClass("bounceIn");setTimeout(function(){$("#footerLast").removeClass("bounceOut").addClass("bounceIn")},400)},700)):hideFooter()}
function hideFooter(){$("#footerFirst, #footerLast").removeClass("bounceIn").addClass("bounceOut");setTimeout(function(){$("#footerRocket").removeClass("bounceIn").addClass("bounceOut")},500)}function showBackButton(){$("#backButton").css("display","block").removeClass("bounceOut").addClass("bounceIn")}function hideBackButton(){$("#backButton").removeClass("bounceIn").addClass("bounceOut")}
function navButtonEvent(a){if(!lockNav)if(lockNav=!0,a.hasClass("selected"))hidePage(!1),setTimeout(function(){$("nav a").removeClass("selected")},300);else{setTimeout(function(){$("nav a").removeClass("selected");a.addClass("selected")},300);var b=a.attr("href");"#Shiblee"===b?window.top.location.href="https://shiblee.me/":showPage(b)}}function flipArticle(a){a.parents("article").toggleClass("flipped")}
if(supported){var startSound=function(){try{backgroundSound.start("backgroundSound"),setVolume(backgroundSound,PLAY_SOUND?VOLUME_MAX:0)}catch(b){}$(window).focus(function(){WINDOW_FOCUS=!0}).blur(function(){WINDOW_FOCUS=!1});var a=WINDOW_FOCUS;setInterval(function(){WINDOW_FOCUS&&!a?PLAY_SOUND&&setVolume(backgroundSound,VOLUME_MAX):WINDOW_FOCUS||setVolume(backgroundSound,0);a=WINDOW_FOCUS},1E3);$(window).on("keydown",function(a){if(83===a.which||32===a.which||77===a.which||80===a.which)(PLAY_SOUND=
!PLAY_SOUND)?(setVolume(backgroundSound,VOLUME_MAX),setCookie("PLAY_SOUND",1)):(setVolume(backgroundSound,0),setCookie("PLAY_SOUND",0))})},setVolume=function(a,b){clearInterval(VOLUME_INTERVAL);var c=b>VOLUME?1:-1;VOLUME_INTERVAL=setInterval(function(){VOLUME+=VOLUME_SPEED*c;if(VOLUME>=b&&1===c||VOLUME<=b&&-1===c)VOLUME=b,clearInterval(VOLUME_INTERVAL);try{a.volume(VOLUME)}catch(d){}},10)};mobile&&!crawler&&addToHomescreen({detectHomescreen:!0,skipFirstVisit:!0,startDelay:20,lifespan:10});$(window).on("touchmove",
function(a){a.preventDefault()});$(window).scroll(function(a){a.preventDefault()});$("section").swipe({swipeLeft:function(a,b,c,d,e){next()},swipeRight:function(a,b,c,d,e){previous()},threshold:Math.min(.1*WINDOW_WIDTH,50),fingers:"all"});$(document).swipe({pinchOut:function(a,b,c,d,e,f){hidePage(!1)},fingers:2,pinchThreshold:Math.min(.05*WINDOW_WIDTH,30)});$("section").mousewheel(function(a,b){wheelX=a.deltaX;wheelY=a.deltaY;return!1});$("#prevButton").click(function(a){previous();return!1});$("#nextButton").click(function(a){next();
return!1});PAGE_SCROLL_INTERVAL=setInterval(function(){var a=(new Date).getTime();(0!=wheelX||0!=wheelY)&&1600<a-lastScroll&&(lastScroll=a,0<(Math.abs(wheelX)>Math.abs(wheelY)?wheelX:-wheelY)?next():previous());wheelX=wheelY=0},50);resizeLayers();$(window).resize(function(){setTimeout(resizeLayers,50)});if(!mobile&&!amazon)try{backgroundSound=new SeamlessLoop,backgroundSound.addUri(SOUND_URL,76799,"backgroundSound"),backgroundSound.callback(startSound)}catch(a){}$("#name").fitText(mobile?2:1.5);$("#title").fitText(mobile?
3.5:2.5);mobile?($("nav a").on("touchstart",function(a){navButtonEvent($(this));return!1}),$(".infoButton, .infoButtonClose").on("touchstart",function(a){flipArticle($(this));return!1})):($("nav a").click(function(a){navButtonEvent($(this));return!1}),$(".infoButton, .infoButtonClose").click(function(a){flipArticle($(this));return!1}));$("#closeButton, #footer").click(function(a){pageVisible&&hidePage(!1);return!1});$("#message .next").click(function(a){proceed();return!1});$(document).keyup(function(a){switch(!0){case 27==
a.keyCode&&pageVisible:hidePage(!1);break;case 37==a.keyCode||38==a.keyCode:previous();break;case 39==a.keyCode||40==a.keyCode:next()}});$("nav a").mouseenter(function(a){!$(this).hasClass("selected")&&PLAY_SOUND&&($("#hover-sound")[0].volume=.15,$("#hover-sound")[0].load(),$("#hover-sound")[0].play())});$(window).load(function(){setParallax();setTooltip();partial?checkPoint():init()})};